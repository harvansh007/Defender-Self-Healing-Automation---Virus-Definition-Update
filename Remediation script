# This script will check if virus definition updated under 5 days.
# If Device is updated within 5 days then it will mark as Complaint
# Change the 5 number according to your standard.
# This script should used as a Remediation script.

try {
$path = $((Get-Wmiobject Win32_Service | where-Object {$_.Name -eq "WinDefend"}).Pathname) -replace "MsMpEng.exe", "" -replace "'", "" 
& "$Path\MpCmdRun.exe" -SignatureUpdate -mmpc

Start-Sleep 10

 If ((Get-MPComputerStatus).AntispywareSignatureAge -le 7 )
  {
 Write-Host "Compliant"
  }
  else 
  {
 Write-Host "Not Compliant"
  }
 }

Catch 
{
Write-Host "Not Compiant Failure"
}
